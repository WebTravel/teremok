'use strict';

;(function () {

  $('document').ready(function () {

    $(document).foundation();

    var w = window.innerWidth ? window.innerWidth : $(window).width(),
        smallWidth = 640,
        speed = 250;

    //Скрипты для десктопной версии
    function desktop() {
      if (w > 1023) {
        $('.menu > li > ul > li > ul > li').each(function () {
          if ($(this).find('ul').length > 0) {
            $(this).find('a').addClass('parent');
          }
        });
      }
    }
    desktop();

    //Скрипты для мобильной версии
    function mobile() {
      if (w < smallWidth) {
        $('.footer__menu--title').on('click', function () {
          $(this).toggleClass('active').next().slideToggle(speed);
        });
      }
    }
    mobile();

    //Мобильное меню
    $('.menu__wrapper').mobileMenu();

    //Слайдер
    $('.slider').slick({
      speed: 300,
      dots: false,
      responsive: [{
        breakpoint: 768,
        settings: {
          arrows: false,
          dots: true
        }
      }]
    });

    //Слайдер брендов
    $('.brandSlider__list').slick({
      dots: true,
      arrows: false,
      slidesToShow: 4,
      slidesToScroll: 1,
      responsive: [{
        breakpoint: 1023,
        settings: {
          slidesToShow: 3,
          slidesToScroll: 1
        }
      }, {
        breakpoint: 767,
        settings: {
          slidesToShow: 2
        }
      }, {
        breakpoint: 480,
        settings: {
          slidesToShow: 1
        }
      }]
    });

    $('#product__panel2, #product__panel1').slick({
      dots: false,
      slidesToShow: 4,
      slidesToScroll: 1,
      responsive: [{
        breakpoint: 1023,
        settings: {
          slidesToShow: 3,
          slidesToScroll: 1
        }
      }, {
        breakpoint: 767,
        settings: {
          slidesToShow: 2
        }
      }, {
        breakpoint: 480,
        settings: {
          slidesToShow: 1
        }
      }]
    });

    //touch-events for slider
    $('.ui-slider-handle ').draggable();

    //Инициализация слайдера
    function uiSlider() {
      jQuery("#slider").slider({
        min: 0,
        max: 1000,
        values: [0, 1000],
        range: true,
        stop: function stop(event, ui) {
          jQuery("input#minCost").val(jQuery("#slider").slider("values", 0));
          jQuery("input#maxCost").val(jQuery("#slider").slider("values", 1));
        },
        slide: function slide(event, ui) {
          jQuery("input#minCost").val(jQuery("#slider").slider("values", 0));
          jQuery("input#maxCost").val(jQuery("#slider").slider("values", 1));
        }
      });

      jQuery("input#minCost").change(function () {
        var value1 = jQuery("input#minCost").val();
        var value2 = jQuery("input#maxCost").val();
        if (parseInt(value1) > parseInt(value2)) {
          value1 = value2;
          jQuery("input#minCost").val(value1);
        }
        jQuery("#slider").slider("values", 0, value1);
      });

      jQuery("input#maxCost").change(function () {

        var value1 = jQuery("input#minCost").val();
        var value2 = jQuery("input#maxCost").val();

        if (parseInt(value1) > parseInt(value2)) {
          value2 = value1;
          jQuery("input#maxCost").val(value2);
        }
        jQuery("#slider").slider("values", 1, value2);
      });

      // фильтрация ввода в поля
      jQuery('input').keypress(function (event) {
        var key, keyChar;
        if (!event) var event = window.event;
        if (event.keyCode) key = event.keyCode;else if (event.which) key = event.which;
        if (key == null || key == 0 || key == 8 || key == 13 || key == 9 || key == 46 || key == 37 || key == 39) return true;
        keyChar = String.fromCharCode(key);
        if (!/\d/.test(keyChar)) return false;
      });
    };
    uiSlider();

    //Раскрытие второго уровня меню в сайдбаре
    $('.leftMenu > ul > li > a').on('click', 'span', function (e) {
      e.preventDefault();
      e.stopPropagation();
      $(this).toggleClass('active').closest('a').next('ul').slideToggle(speed);
    });

    //Раскрытие тела одной категории фильтра
    $('.filter__name').on('click', function () {
      $(this).toggleClass('no-active').next('.filter__body').slideToggle(speed);
    });

    //Скрываем часть фильтров при загрузке
    function filterItemHidden() {
      var count = 2;
      $('.filter').find(function () {
        if ($(this).find('.filter__item').length > count) {
          $(this).find('.filter__item').eq(count - 1).nextAll().find('.filter__name').addClass('no-active').next('.filter__body').css({ 'display': 'none' });
        }
      });
    };
    filterItemHidden

    //Разворачивание инпутов в фильтре
    ();function filterCompany() {
      var count = 3,
          selector = '<div class="company__wrap" />',
          switchSel = $('.filter__toggle'),
          switchSelText = switchSel.text(),
          switchSelNewText = '- Свернуть';
      $('.filter__company').find(function () {
        if ($(this).find('.filter__company--item').length > count) {
          $(this).find('.filter__company--item').eq(count - 1).nextAll().wrapAll(selector);
        }
      });
      switchSel.on('click', function () {
        $('.company__wrap').slideToggle(speed);
        if ($(this).text() == switchSelNewText) {
          $(this).text(switchSelText);
        } else {
          $(this).text(switchSelNewText);
        }
      });
    };

    filterCompany();
  });
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwicmVhZHkiLCJkb2N1bWVudCIsImZvdW5kYXRpb24iLCJ3Iiwid2luZG93IiwiaW5uZXJXaWR0aCIsIndpZHRoIiwic21hbGxXaWR0aCIsInNwZWVkIiwiZGVza3RvcCIsImVhY2giLCJmaW5kIiwibGVuZ3RoIiwiYWRkQ2xhc3MiLCJtb2JpbGUiLCJvbiIsInRvZ2dsZUNsYXNzIiwibmV4dCIsInNsaWRlVG9nZ2xlIiwibW9iaWxlTWVudSIsInNsaWNrIiwiZG90cyIsInJlc3BvbnNpdmUiLCJicmVha3BvaW50Iiwic2V0dGluZ3MiLCJhcnJvd3MiLCJzbGlkZXNUb1Nob3ciLCJzbGlkZXNUb1Njcm9sbCIsImRyYWdnYWJsZSIsInVpU2xpZGVyIiwialF1ZXJ5Iiwic2xpZGVyIiwibWluIiwibWF4IiwidmFsdWVzIiwicmFuZ2UiLCJzdG9wIiwiZXZlbnQiLCJ1aSIsInZhbCIsInNsaWRlIiwiY2hhbmdlIiwidmFsdWUxIiwidmFsdWUyIiwicGFyc2VJbnQiLCJrZXlwcmVzcyIsImtleSIsImtleUNoYXIiLCJrZXlDb2RlIiwid2hpY2giLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJ0ZXN0IiwiZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiY2xvc2VzdCIsImZpbHRlckl0ZW1IaWRkZW4iLCJjb3VudCIsImVxIiwibmV4dEFsbCIsImNzcyIsImZpbHRlckNvbXBhbnkiLCJzZWxlY3RvciIsInN3aXRjaFNlbCIsInN3aXRjaFNlbFRleHQiLCJ0ZXh0Iiwic3dpdGNoU2VsTmV3VGV4dCIsIndyYXBBbGwiXSwibWFwcGluZ3MiOiI7O0FBQUEsQ0FBRSxhQUFXOztBQUdYQSxJQUFFLFVBQUYsRUFBY0MsS0FBZCxDQUFvQixZQUFXOztBQUU3QkQsTUFBRUUsUUFBRixFQUFZQyxVQUFaOztBQUVBLFFBQUlDLElBQUlDLE9BQU9DLFVBQVAsR0FBb0JELE9BQU9DLFVBQTNCLEdBQXdDTixFQUFF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O0FBS0FDLGdCQUFVakQsRUFBVixDQUFhLE9BQWIsRUFBc0IsWUFBVztBQUMvQmhCLFVBQUUsZ0JBQUYsRUFBb0JtQixXQUFwQixDQUFnQ1YsS0FBaEM7QUFDQSxZQUFHVCxFQUFFLElBQUYsRUFBUW1FLElBQVIsTUFBa0JDLGdCQUFyQixFQUF1QztBQUNyQ3BFLFlBQUUsSUFBRixFQUFRbUUsSUFBUixDQUFhRCxhQUFiO0FBQ0QsU0FGRCxNQUVPO0FBQ0xsRSxZQUFFLElBQUYsRUFBUW1FLElBQVIsQ0FBYUMsZ0JBQWI7QUFDRDtBQUNGLE9BUEQ7QUFRRDs7QUFFREw7QUFFRCxHQWxORDtBQW9ORCxDQXZOQyxHQUFEIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24oKSB7XG5cblxuICAkKCdkb2N1bWVudCcpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIFxuICAgICQoZG9jdW1lbnQpLmZvdW5kYXRpb24oKTtcblxuICAgIHZhciB3ID0gd2luZG93LmlubmVyV2lkdGggPyB3aW5kb3cuaW5uZXJXaWR0aCA6ICQod2luZG93KS53aWR0aCgpLFxuICAgICAgICBzbWFsbFdpZHRoID0gNjQwLFxuICAgICAgICBzcGVlZCA9IDI1MDtcblxuXG4gICAgLy/QodC60YDQuNC/0YLRiyDQtNC70Y8g0LTQtdGB0LrRgtC+0L/QvdC+0Lkg0LLQtdGA0YHQuNC4XG4gICAgZnVuY3Rpb24gZGVza3RvcCgpIHtcbiAgICAgIGlmKHcgPiAxMDIzKSB7XG4gICAgICAgICQoJy5tZW51ID4gbGkgPiB1bCA+IGxpID4gdWwgPiBsaScpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYoJCh0aGlzKS5maW5kKCd1bCcpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICQodGhpcykuZmluZCgnYScpLmFkZENsYXNzKCdwYXJlbnQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBkZXNrdG9wKCk7IFxuXG5cbiAgICAvL9Ch0LrRgNC40L/RgtGLINC00LvRjyDQvNC+0LHQuNC70YzQvdC+0Lkg0LLQtdGA0YHQuNC4XG4gICAgZnVuY3Rpb24gbW9iaWxlKCkge1xuICAgICAgaWYodyA8IHNtYWxsV2lkdGgpIHtcbiAgICAgICAgJCgnLmZvb3Rlcl9fbWVudS0tdGl0bGUnKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpLm5leHQoKS5zbGlkZVRvZ2dsZShzcGVlZCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBtb2JpbGUoKTtcblxuICAgIC8v0JzQvtCx0LjQu9GM0L3QvtC1INC80LXQvdGOXG4gICAgJCgnLm1lbnVfX3dyYXBwZXInKS5tb2JpbGVNZW51KCk7XG5cbiAgICAvL9Ch0LvQsNC50LTQtdGAXG4gICAgJCgnLnNsaWRlcicpLnNsaWNrKHtcbiAgICAgIHNwZWVkOiAzMDAsXG4gICAgICBkb3RzOiBmYWxzZSxcbiAgICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgICAge1xuICAgICAgICAgIGJyZWFrcG9pbnQ6IDc2OCxcbiAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgYXJyb3dzOiBmYWxzZSxcbiAgICAgICAgICAgIGRvdHM6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9KTtcblxuICAgIC8v0KHQu9Cw0LnQtNC10YAg0LHRgNC10L3QtNC+0LJcbiAgICAkKCcuYnJhbmRTbGlkZXJfX2xpc3QnKS5zbGljayh7XG4gICAgICBkb3RzOiB0cnVlLFxuICAgICAgYXJyb3dzOiBmYWxzZSxcbiAgICAgIHNsaWRlc1RvU2hvdzogNCxcbiAgICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxuICAgICAgcmVzcG9uc2l2ZTogW1xuICAgICAgICB7XG4gICAgICAgICAgYnJlYWtwb2ludDogMTAyMyxcbiAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAzLFxuICAgICAgICAgICAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgYnJlYWtwb2ludDogNzY3LFxuICAgICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDIsXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgYnJlYWtwb2ludDogNDgwLFxuICAgICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG5cbiAgICAkKCcjcHJvZHVjdF9fcGFuZWwyLCAjcHJvZHVjdF9fcGFuZWwxJykuc2xpY2soe1xuICAgICAgZG90czogZmFsc2UsXG4gICAgICBzbGlkZXNUb1Nob3c6IDQsXG4gICAgICBzbGlkZXNUb1Njcm9sbDogMSxcbiAgICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgICAge1xuICAgICAgICAgIGJyZWFrcG9pbnQ6IDEwMjMsXG4gICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogMyxcbiAgICAgICAgICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGJyZWFrcG9pbnQ6IDc2NyxcbiAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAyLFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGJyZWFrcG9pbnQ6IDQ4MCxcbiAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0pO1xuXG4gICAgLy90b3VjaC1ldmVudHMgZm9yIHNsaWRlclxuICAgICQoJy51aS1zbGlkZXItaGFuZGxlICcpLmRyYWdnYWJsZSgpO1xuXG4gICAgLy/QmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDRgdC70LDQudC00LXRgNCwXG4gICAgZnVuY3Rpb24gdWlTbGlkZXIoKSB7XG4gICAgICBqUXVlcnkoXCIjc2xpZGVyXCIpLnNsaWRlcih7XG4gICAgICAgIG1pbjogMCxcbiAgICAgICAgbWF4OiAxMDAwLFxuICAgICAgICB2YWx1ZXM6IFswLDEwMDBdLFxuICAgICAgICByYW5nZTogdHJ1ZSxcbiAgICAgICAgc3RvcDogZnVuY3Rpb24oZXZlbnQsIHVpKSB7XG4gICAgICAgICAgalF1ZXJ5KFwiaW5wdXQjbWluQ29zdFwiKS52YWwoalF1ZXJ5KFwiI3NsaWRlclwiKS5zbGlkZXIoXCJ2YWx1ZXNcIiwwKSk7XG4gICAgICAgICAgalF1ZXJ5KFwiaW5wdXQjbWF4Q29zdFwiKS52YWwoalF1ZXJ5KFwiI3NsaWRlclwiKS5zbGlkZXIoXCJ2YWx1ZXNcIiwxKSk7XG4gICAgICAgICAgXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzbGlkZTogZnVuY3Rpb24oZXZlbnQsIHVpKXtcbiAgICAgICAgICBqUXVlcnkoXCJpbnB1dCNtaW5Db3N0XCIpLnZhbChqUXVlcnkoXCIjc2xpZGVyXCIpLnNsaWRlcihcInZhbHVlc1wiLDApKTtcbiAgICAgICAgICBqUXVlcnkoXCJpbnB1dCNtYXhDb3N0XCIpLnZhbChqUXVlcnkoXCIjc2xpZGVyXCIpLnNsaWRlcihcInZhbHVlc1wiLDEpKTtcbiAgICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgalF1ZXJ5KFwiaW5wdXQjbWluQ29zdFwiKS5jaGFuZ2UoZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHZhbHVlMT1qUXVlcnkoXCJpbnB1dCNtaW5Db3N0XCIpLnZhbCgpO1xuICAgICAgICB2YXIgdmFsdWUyPWpRdWVyeShcImlucHV0I21heENvc3RcIikudmFsKCk7XG4gICAgICAgICAgaWYocGFyc2VJbnQodmFsdWUxKSA+IHBhcnNlSW50KHZhbHVlMikpe1xuICAgICAgICAgIHZhbHVlMSA9IHZhbHVlMjtcbiAgICAgICAgICBqUXVlcnkoXCJpbnB1dCNtaW5Db3N0XCIpLnZhbCh2YWx1ZTEpO1xuICAgICAgICB9XG4gICAgICAgIGpRdWVyeShcIiNzbGlkZXJcIikuc2xpZGVyKFwidmFsdWVzXCIsMCx2YWx1ZTEpO1x0XG4gICAgICB9KTtcblxuICAgICAgICBcbiAgICAgIGpRdWVyeShcImlucHV0I21heENvc3RcIikuY2hhbmdlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgXG4gICAgICAgIHZhciB2YWx1ZTE9alF1ZXJ5KFwiaW5wdXQjbWluQ29zdFwiKS52YWwoKTtcbiAgICAgICAgdmFyIHZhbHVlMj1qUXVlcnkoXCJpbnB1dCNtYXhDb3N0XCIpLnZhbCgpO1xuXG4gICAgICAgIGlmKHBhcnNlSW50KHZhbHVlMSkgPiBwYXJzZUludCh2YWx1ZTIpKXtcbiAgICAgICAgICB2YWx1ZTIgPSB2YWx1ZTE7XG4gICAgICAgICAgalF1ZXJ5KFwiaW5wdXQjbWF4Q29zdFwiKS52YWwodmFsdWUyKTtcbiAgICAgICAgfVxuICAgICAgICBqUXVlcnkoXCIjc2xpZGVyXCIpLnNsaWRlcihcInZhbHVlc1wiLDEsdmFsdWUyKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyDRhNC40LvRjNGC0YDQsNGG0LjRjyDQstCy0L7QtNCwINCyINC/0L7Qu9GPXG4gICAgICBqUXVlcnkoJ2lucHV0Jykua2V5cHJlc3MoZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICB2YXIga2V5LCBrZXlDaGFyO1xuICAgICAgICBpZighZXZlbnQpIHZhciBldmVudCA9IHdpbmRvdy5ldmVudDtcbiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUpIGtleSA9IGV2ZW50LmtleUNvZGU7XG4gICAgICAgIGVsc2UgaWYoZXZlbnQud2hpY2gpIGtleSA9IGV2ZW50LndoaWNoO1xuICAgICAgICBpZihrZXk9PW51bGwgfHwga2V5PT0wIHx8IGtleT09OCB8fCBrZXk9PTEzIHx8IGtleT09OSB8fCBrZXk9PTQ2IHx8IGtleT09MzcgfHwga2V5PT0zOSApIHJldHVybiB0cnVlO1xuICAgICAgICBrZXlDaGFyPVN0cmluZy5mcm9tQ2hhckNvZGUoa2V5KTsgXG4gICAgICAgIGlmKCEvXFxkLy50ZXN0KGtleUNoYXIpKVx0cmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB1aVNsaWRlcigpO1xuXG4gICAgLy/QoNCw0YHQutGA0YvRgtC40LUg0LLRgtC+0YDQvtCz0L4g0YPRgNC+0LLQvdGPINC80LXQvdGOINCyINGB0LDQudC00LHQsNGA0LVcbiAgICAkKCcubGVmdE1lbnUgPiB1bCA+IGxpID4gYScpLm9uKCdjbGljaycsICdzcGFuJywgZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpLmNsb3Nlc3QoJ2EnKS5uZXh0KCd1bCcpLnNsaWRlVG9nZ2xlKHNwZWVkKTtcbiAgICB9KTtcblxuICAgIC8v0KDQsNGB0LrRgNGL0YLQuNC1INGC0LXQu9CwINC+0LTQvdC+0Lkg0LrQsNGC0LXQs9C+0YDQuNC4INGE0LjQu9GM0YLRgNCwXG4gICAgJCgnLmZpbHRlcl9fbmFtZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcygnbm8tYWN0aXZlJykubmV4dCgnLmZpbHRlcl9fYm9keScpLnNsaWRlVG9nZ2xlKHNwZWVkKTtcbiAgICB9KTtcblxuICAgIC8v0KHQutGA0YvQstCw0LXQvCDRh9Cw0YHRgtGMINGE0LjQu9GM0YLRgNC+0LIg0L/RgNC4INC30LDQs9GA0YPQt9C60LVcbiAgICBmdW5jdGlvbiBmaWx0ZXJJdGVtSGlkZGVuKCkge1xuICAgICAgdmFyIGNvdW50ID0gMjtcbiAgICAgICQoJy5maWx0ZXInKS5maW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZigkKHRoaXMpLmZpbmQoJy5maWx0ZXJfX2l0ZW0nKS5sZW5ndGggPiBjb3VudCkge1xuICAgICAgICAgICQodGhpcykuZmluZCgnLmZpbHRlcl9faXRlbScpLmVxKGNvdW50IC0gMSkubmV4dEFsbCgpLmZpbmQoJy5maWx0ZXJfX25hbWUnKS5hZGRDbGFzcygnbm8tYWN0aXZlJykubmV4dCgnLmZpbHRlcl9fYm9keScpLmNzcyh7J2Rpc3BsYXknOidub25lJ30pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIGZpbHRlckl0ZW1IaWRkZW4oKVxuXG4gICAgLy/QoNCw0LfQstC+0YDQsNGH0LjQstCw0L3QuNC1INC40L3Qv9GD0YLQvtCyINCyINGE0LjQu9GM0YLRgNC1XG4gICAgZnVuY3Rpb24gZmlsdGVyQ29tcGFueSgpIHtcbiAgICAgIHZhciBjb3VudCA9IDMsXG4gICAgICAgICAgc2VsZWN0b3IgPSAnPGRpdiBjbGFzcz1cImNvbXBhbnlfX3dyYXBcIiAvPicsXG4gICAgICAgICAgc3dpdGNoU2VsID0gJCgnLmZpbHRlcl9fdG9nZ2xlJyksXG4gICAgICAgICAgc3dpdGNoU2VsVGV4dCA9IHN3aXRjaFNlbC50ZXh0KCksXG4gICAgICAgICAgc3dpdGNoU2VsTmV3VGV4dCA9ICctINCh0LLQtdGA0L3Rg9GC0YwnO1xuICAgICAgJCgnLmZpbHRlcl9fY29tcGFueScpLmZpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCQodGhpcykuZmluZCgnLmZpbHRlcl9fY29tcGFueS0taXRlbScpLmxlbmd0aCA+IGNvdW50KSB7XG4gICAgICAgICAgJCh0aGlzKS5maW5kKCcuZmlsdGVyX19jb21wYW55LS1pdGVtJykuZXEoY291bnQgLSAxKS5uZXh0QWxsKCkud3JhcEFsbChzZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgc3dpdGNoU2VsLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcuY29tcGFueV9fd3JhcCcpLnNsaWRlVG9nZ2xlKHNwZWVkKTtcbiAgICAgICAgaWYoJCh0aGlzKS50ZXh0KCkgPT0gc3dpdGNoU2VsTmV3VGV4dCkge1xuICAgICAgICAgICQodGhpcykudGV4dChzd2l0Y2hTZWxUZXh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkKHRoaXMpLnRleHQoc3dpdGNoU2VsTmV3VGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmaWx0ZXJDb21wYW55KCk7XG5cbiAgfSk7XG5cbn0oKSk7Il19
